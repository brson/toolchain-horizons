<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Toolchain Horizons - Dependency Toolchain Compatibility</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=JetBrains+Mono&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="styles.css">
</head>
<body>

<div id="stars"></div>

<div id="impress" data-transition-duration="100" data-min-scale="1">

  <div class="step slide-title" data-x="0" data-y="0">
    <h1>TigerBeetle 1000x walkin slide</h1>

    <aside class="notes">
    </aside>
  </div>

  <div class="step slide-title" data-x="0" data-y="0">
    <h1>Toolchain Horizons</h1>
    <p class="subtitle">
      Exploring<br>
      Dependency-Toolchain<br>
      Compatibility<br>
    </p>
    <p><a href="https://github.com/brson/toolchain-horizons">github.com/brson/toolchain-horizons</a></p>

    <aside class="notes">
      Thanks for coming...
    </aside>
  </div>

  <!-- act 1 -->

  <div class="step" data-x="2400" data-y="0">
    <h2>Me and TigerBeetle</h2>
    <div class="slide-content side-by-side">
      <figure>
        <div class="img-container">
          <img src="assets/brson.png" alt="Brian Anderson">
        </div>
        <figcaption><a href="https://brson.github.io">brson.github.io</a></figcaption>
      </figure>
      <figure>
        <div class="img-container">
          <img src="assets/tigerbeetle.png" alt="TigerBeetle mascot">
        </div>
        <figcaption><a href="https://tigerbeetle.com">tigerbeetle.com</a></figcaption>
      </figure>
    </div>
    <aside class="notes">
      ME: rust expert. Mozilla years.<br>
      TB: Strong technical / market niche.<br>
      TB: Joran right-minded business.<br>
      ME: No rust yes zig<br>
      ME: NO RUST YES ZIG<br>
      ME: NO RUST YES ZIG<br>
      <b>So whats this talk about ?? (next)</b>
    </aside>
  </div>

  <div class="step slide-callout" data-x="2400" data-y="0">
    <p class="callout">
      I made a<br>
      TigerBeetle<br>
      Rust client
    </p>
    <aside class="notes">
      This talk is about my experience building the TigerBeetle Rust client.
    </aside>
  </div>

  <div class="step" data-x="2400" data-y="0">
    <div class="slide-content split-horizontal">
      <div class="split-panel">
        <p>I got mad about software dependencies.</p>
        <img src="assets/frustration.jpg" alt="Frustration">
      </div>
      <div class="split-panel">
        <img src="assets/science.jpg" alt="Science experiment">
        <p>I did an experiment about it.</p>
      </div>
    </div>
    <aside class="notes">
      More specifically.<br>
      About my experience removing dependencies from the TigerBeetle Rust client.<br>
      Including experiment.
    </aside>
  </div>
  
  <div class="step" data-x="3600" data-y="0">
    <h2>TigerBeetle Clients</h2>
    <div class="slide-content client-arch">
      <div class="client-arch-diagram">
        <!-- SVG arrows pointing to center -->
        <svg class="client-arch-arrows" viewBox="0 0 600 600">
          <defs>
            <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
              <polygon points="0 0, 10 3.5, 0 7" fill="#666"/>
            </marker>
          </defs>
          <!-- Arrows from each node to center -->
          <line x1="300" y1="120" x2="300" y2="210" stroke="#666" stroke-width="3" marker-end="url(#arrowhead)"/>
          <line x1="480" y1="160" x2="400" y2="230" stroke="#666" stroke-width="3" marker-end="url(#arrowhead)"/>
          <line x1="480" y1="440" x2="400" y2="370" stroke="#666" stroke-width="3" marker-end="url(#arrowhead)"/>
          <line x1="300" y1="480" x2="300" y2="390" stroke="#666" stroke-width="3" marker-end="url(#arrowhead)"/>
          <line x1="120" y1="440" x2="200" y2="370" stroke="#666" stroke-width="3" marker-end="url(#arrowhead)"/>
          <line x1="120" y1="160" x2="200" y2="230" stroke="#666" stroke-width="3" marker-end="url(#arrowhead)"/>
        </svg>
        <!-- Outer client nodes -->
        <div class="client-arch-node"><img src="assets/python.svg" alt="Python"></div>
        <div class="client-arch-node"><img src="assets/java.svg" alt="Java"></div>
        <div class="client-arch-node"><img src="assets/go.png" alt="Go"></div>
        <div class="client-arch-node"><img src="assets/nodejs.svg" alt="Node.js"></div>
        <div class="client-arch-node"><img src="assets/dotnet.jpg" alt=".NET"></div>
        <div class="client-arch-node"><img src="assets/rust.png" alt="Rust"></div>
        <!-- Center Zig node -->
        <div class="client-arch-center">
          <img src="assets/zig.svg" alt="Zig">
        </div>
      </div>
    </div>
    <aside class="notes">
      All clients depend on tb_client, written in Zig.
    </aside>
  </div>

  <div class="step" data-x="4800" data-y="0">
    <h2>The TigerBeetle Rust Client</h2>
    <div class="slide-content split-horizontal code-split">
      <div class="split-panel">
        <p>Rust</p>
        <pre><code>pub fn lookup_transfers(
    &self,
    events: &[u128],
) -> impl Future&lt;...&gt; {
    let (packet, rx) = create_packet(
        TB_OPERATION_LOOKUP_TRANSFERS,
        events,
    );

    unsafe {
        tb_client_submit(
            self.client,
            Box::into_raw(packet),
        );
    }

    async {
        let msg = rx.await?;
        let responses = handle_message(&msg)?;
        Ok(Vec::from(responses))
    }
}</code></pre>
      </div>
      <div class="split-panel">
        <p>Zig</p>
        <pre><code>pub fn submit(
    client: *ClientInterface,
    packet: *Packet.Extern,
) Error!void {
    if (client.magic_number != beetle)
        return Error.ClientInvalid;

    client.locker.lock();
    defer client.locker.unlock();

    const context = client.context.ptr
        orelse return Error.ClientInvalid;

    client.vtable.ptr.submit_fn(
        context,
        packet,
    );
}</code></pre>
      </div>
    </div>

    <aside class="notes">
      Code isn't important.<br>
      &lt; 2 kloc <br>
      async / await <br>
      mostly unsafe <br>
      partial codegen <br>
    </aside>
  </div>

  <div class="step" data-x="8400" data-y="0">
    <h2>Establishing a<br>Minimum Supported Rust Version</h2>
    <div class="slide-content">
      <p>Content placeholder</p>
    </div>
    <aside class="notes">
      todo
    </aside>
  </div>

  <div class="step slide-callout" data-x="6000" data-y="0">
    <p class="callout">
      Initial MSRV<br>
      Rust 1.81<br>
      September 5, 2024<br>
      yikes
    </p>
    <aside class="notes">
      Build script fs::exists, stabilized in 1.81.<br>
      Cargo lockfile v4, May 2024, todo what rust version?<br>
      This was in June 2025, 9 months later.<br>
    </aside>
  </div>


  <!-- act 2 -->
  

  <div class="step slide-section" data-x="7200" data-y="0">
    <h2>The TigerStyle Mindset</h2>
    <p>todo closeup image of person experiencing enlightenment</p>
    <aside class="notes">
      Interlude.<br>
      TigerBeetle strict <b>software development</b> guidelines<br>
      <b>TIGER STYLE</b><br>
    </aside>
  </div>

  <div class="step" data-x="6000" data-y="0">
    <h2>Rust Client Dependencies</h2>
    <div class="slide-content">
      <h3>Cargo.toml</h3>
      <pre>

      [dependencies]
      bitflags = "2.6.0"
      futures = "0.3.31"
      thiserror = "2.0.3"

      [build-dependencies]
      anyhow = "1.0.93"
      ignore = "0.4.23"

      [dev-dependencies]
      anyhow = "1.0.93"
      tempfile = "3.15.0"
      </pre>

      <p><a>todo link to pr</a></p>
    </div>
    <aside class="notes">
      What version of Rust was this compatible with? (next)
    </aside>
  </div>

  <div class="step slide-code" data-x="9600" data-y="0">
    <h2>The Rust <code>futures</code> <br> Dependency Problem</h2>
      <pre class="small-code">futures v0.3.31
├── futures-channel v0.3.31
│   ├── futures-core v0.3.31
│   └── futures-sink v0.3.31
├── futures-core v0.3.31
├── futures-executor v0.3.31
│   ├── futures-core v0.3.31
│   ├── futures-task v0.3.31
│   └── futures-util v0.3.31
│       ├── futures-channel v0.3.31 (*)
│       ├── futures-core v0.3.31
│       ├── futures-io v0.3.31
│       ├── futures-macro v0.3.31 (proc-macro)
│       │   ├── proc-macro2 v1.0.90
│       │   │   └── unicode-ident v1.0.14
│       │   ├── quote v1.0.37
│       │   │   └── proc-macro2 v1.0.90 (*)
│       │   └── syn v2.0.88
│       │       ├── proc-macro2 v1.0.90 (*)
│       │       ├── quote v1.0.37 (*)
│       │       └── unicode-ident v1.0.14
│       ├── futures-sink v0.3.31
│       ├── futures-task v0.3.31
│       ├── memchr v2.7.4
│       ├── pin-project-lite v0.2.15
│       ├── pin-utils v0.1.0
│       └── slab v0.4.9
├── futures-io v0.3.31
├── futures-sink v0.3.31
├── futures-task v0.3.31
└── futures-util v0.3.31 (*)
    </pre>
    <aside class="notes">
      Fundamental crate.
      We use: channels, block_on executor, Stream.<br>
      Not in public API.<br>
      Point out syn crate.<br>
    </aside>
  </div>

  <div class="step" data-x="10800" data-y="0">
    <h2>The Experiment</h2>
    <div class="slide-content">
      <p>Content placeholder</p>
    </div>
    <aside class="notes">
      todo
    </aside>
  </div>

  <div class="step" data-x="12000" data-y="0">
    <h2>Toolchain Horizons: Rust</h2>
    <div class="slide-content">
      <p>Content placeholder</p>
    </div>
    <aside class="notes">
      todo
    </aside>
  </div>

  <div class="step slide-image" data-x="12000" data-y="0">
    <div class="slide-content">
      <img src="../compatibility-timeline-rust.png" alt="Rust compatibility timeline">
    </div>
    <aside class="notes">
      todo
    </aside>
  </div>


  <!-- act 3 -->


  <div class="step slide-section" data-x="13200" data-y="0">
    <h2><i>A TigerBeetle<br>Rust Client<br>Compatibility Quest!</i></h2>
    <aside class="notes">
      Personal quest.<br>
      Some in-tree, some not.<br>
    </aside>
  </div>

  <div class="step" data-x="9600" data-y="0">
    <h2>Compatibility Quest Timeline</h2>
    <div class="slide-content">
      <p>todo a diagram/timeline of all the steps we took</p>
    </div>
    <aside class="notes">
      
    </aside>
  </div>

  <div class="step" data-x="9600" data-y="0">
    <h2>Removing the <code>futures</code> Dependency</h2>
    <div class="slide-content">
      <p>Content placeholder</p>
    </div>
    <aside class="notes">
      todo
    </aside>
  </div>

  <div class="step" data-x="7200" data-y="0">
    <h2>Does It Even Matter?</h2>
    <div class="slide-content">
      <p>Content placeholder</p>
    </div>
    <aside class="notes">
      Can't use tokio in examples or docs.
    </aside>
  </div>

  <div class="step slide-section" data-x="0" data-y="0">
    <h2>Time Check</h2>

    <aside class="notes">
      Do we have time for more?
    </aside>
  </div>

  <div class="step slide-title" data-x="0" data-y="0">
    <h1>Toolchain Horizons</h1>
    <p class="subtitle">
      Exploring<br>
      Dependency-Toolchain<br>
      Compatibility<br>
    </p>
    <p><a href="https://github.com/brson/toolchain-horizons">github.com/brson/toolchain-horizons</a></p>

    <aside class="notes">
      Thanks for coming...
    </aside>
  </div>


  <!-- appendices -->

  <div class="step slide-section" data-x="13200" data-y="0">
    <h2>Appendix</h2>
  </div>

  <div class="step" data-x="14400" data-y="0">
    <h2>Toolchain Horizons: Java</h2>
    <div class="slide-content">
      <p>Java doesn't seem to have this problem.</p>
    </div>
    <aside class="notes">
      todo
    </aside>
  </div>

  <div class="step" data-x="14400" data-y="0">
    <h2>Toolchain Horizons: Go</h2>
    <div class="slide-content">
      <p>Modules introduced 1.13, September 19.</p>
      <p>~60% compatibility.</p>
    </div>
    <aside class="notes">
      Go 1.13 (60%): mux, cobra, logrus, yaml, pq, uuid, websocket, httprouter, jwt-go, redigo, elasticsearch, aws-sdk.<br>
      Go 1.17-1.19: testify, cli/v2, chi, zap.<br>
      Go 1.21 (30%): gin, echo, grpc, prometheus, x/sync, x/crypto, mysql, resty.<br>
      Modern web frameworks and Google libs require recent Go.
    </aside>
  </div>

  <div class="step slide-image" data-x="12000" data-y="0">
    <div class="slide-content">
      <img src="../compatibility-timeline-go.png" alt="Go compatibility timeline">
    </div>
    <aside class="notes">
      todo
    </aside>
  </div>

  <div class="step slide-title" data-x="0" data-y="0">
    <h1>Toolchain Horizons</h1>
    <p class="subtitle">
      Exploring<br>
      Dependency-Toolchain<br>
      Compatibility<br>
    </p>
    <p><a href="https://github.com/brson/toolchain-horizons">github.com/brson/toolchain-horizons</a></p>

    <aside class="notes">
      Thanks for coming...
    </aside>
  </div>

</div>

<script src="impress.js"></script>
<script src="presentation.js"></script>

</body>
</html>

<!--

    msvr slide in wrong place
    name feature epochs in rust chart
    
    -->
